import requests
import datetime
import json


vins = ['W0LSD9EM0D4174175',
'Z6FXXXESFXCS06532',
'Z6FDXXESGDHA67984',
'X9W215821H0008750',
'XWEGX413BH0004010',
'ZWEJP811BJ0007854',
'Z6FDXXESGDHD78416',
'X9L21230040634392',
'VF7YAZMFB12E78406',
'XWEPG81AAHH0002484',
'794C241BAJR007363',
'XWEB2512BJ0000207',
'Z94CB41BBHR458090',
'1C4PJMDB0FW555907',
'KNALT811BB7725807',
'ZFA25000002D17608',
'Z6FXXXESFXCT20558',
'Z94C341BBJR009969',
'U5YPC81ADEL555339',
'KNABX312BFJ878586',
'Z6F4XXEEC4HB33604',
'KPTA0A18SDP134182',
'XWEPH814DH0001082',
'X9FDXXEEBDCL44443',
'X7L4SRAV454996983',
'Z6FDXXESGDHJ56945',
'W0LGT6GU1E1087683',
'Z94CC41BBHR451121',
'YV1PZA8ACH1003957',
'XWEPHB1ADH0016284',
'XWEGU411BJ0004836',
'XWEKU814DHC005580',
'X7L5SRAVG59250131',
'VF3M45GXVHS160323',
'X9W215851G0003195',
'Z94CB41BBHR454775',
'Z94C241BAJR018029',
'XWEGV412BJ0001989',
'XWEPH81BDH0007761',
'Z94C241BBJR008149',
'Z94C241AAJR032538',
'XWEGU411BH0002157',
'Z94CC41BBHR448943',
'Z94CB41ABHR443254',
'XWEFX411BHC004568',
'Z94CB51BBHR100982',
'SALCA2BN1HH710514',
'XWEGT411BJ0002856',
'X7LHSRGA557195059',
'Z6FAXXESMAHK75313',
'XWEGU411BH0001837',
'XWEGW413BJ0005033',
'Z94C241BBJR043235',
'Z94C241BAJR049343',
'X7LHSRGA557793281',
'X9W215800H0049390',
'XWEKU814DHC005264',
'XWEPH81ADH0010030',
'YV1LF08ACJ1198208',
'Z6F4XXEEC4HE44846',
'Z94CB51BBHR103445',
'Z94C251BBJR001822',
'SALVA2BX8JH275846',
'X7LASRBA659239022',
'X7LHSRHGN59257115',
'X7L5SRAVG57187778',
'X7L4SRAV458462769',
'Z94CB41BBHR461215',
'Z94C241BBJR004320',
'Z6FDXXESGDHG70046',
'ZFA250000H2E08080',
'1C4RJFDJ9JC212664',
'X7L5SRAVG59046297',
'X9L212300J0642582',
'Z8TND5GXAHM031233',
'XWEJN811BH0002654',
'SADCA2BN2JA271592',
'Z6FAXXESMAHD80083',
'SALRA2BK4HA010477',
]


for vin in vins:
    start = datetime.datetime.now()

    res = requests.get(f"""http://192.168.5.37:3370/get_info?vin={vin}""")

    if res.status_code!=200:
        continue

    sec = str((datetime.datetime.now() - start).seconds)

    print(f"{sec}  {vin}  {res.text}")

    res = json.loads(res.text)

    print('')


    dt = ''

    try:
        dt = res['RequestResult']['ownershipPeriods']['ownershipPeriod'][0]['from']
    except:
        continue

    f = open('result.txt', 'a')

    f.write(vin+';'+dt[0:10]+';'+res['RequestResult']['vehicle']['year']+';'+str(len(res['RequestResult']['ownershipPeriods']['ownershipPeriod']))+'\n')

    f.close()

